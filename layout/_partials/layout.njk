{% import '_macro/sidebar.njk' as sidebar with context %}
{% import '_macro/breadcrumb.njk' as breadcrumb with context %}
{% import '_macro/widgets.njk' as widgets with context %}

<!DOCTYPE html>
<html lang="{{ page.language if page.language else config.language }}">
<head>
  {{ partial('_partials/head/head.njk', {}, {cache: true}) }}
  {{ partial('_partials/head/head_unique.njk') }}
  <title>{% block title %}{% endblock %}{{ alternate + " = " if alternate }}{{ title }}{{ " = "+subtitle if subtitle }}</title>
</head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="socket">
      <div class="gel center-gel">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c1 r1">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c2 r1">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c3 r1">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c4 r1">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c5 r1">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c6 r1">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      
      <div class="gel c7 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      
      <div class="gel c8 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c9 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c10 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c11 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c12 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c13 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c14 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c15 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c16 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c17 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c18 r2">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c19 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c20 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c21 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c22 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c23 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c24 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c25 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c26 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c28 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c29 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c30 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c31 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c32 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c33 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c34 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c35 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c36 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
      <div class="gel c37 r3">
        <div class="hex-brick h1"></div>
        <div class="hex-brick h2"></div>
        <div class="hex-brick h3"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          {% block header %}
            <a href="{{ config.root }}" class="logo" rel="start">
              {%- if alternate %}<p class="artboard">{{ alternate }}</p>{%- endif %}
              <h1 itemprop="name headline" class="title">{{ title }}</h1>
            </a>
            {%- if subtitle %}
            <p class="meta" itemprop="description">= {{ subtitle }} =</p>
            {%- endif %}
          {% endblock %}
          </div>
        </div>
        {{ partial('_partials/header.njk', {}, {cache: true}) }}
      </div>
      <div id="imgs" class="pjax">
      {%- set covers = _cover(page, 6) %}
      {%- if covers.length == 6 %}
        <ul>
          {%- for image in covers %}
          <li class="item" data-background-image="{{ image }}"></li>
          {%- endfor %}
        </ul>
      {%- else %}
          <img src="{{ covers }}">
      {%- endif %}
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          {% block content %}{% endblock %}
        </div>
        <div id="sidebar">
          {% block sidebar %}{{ sidebar.render() }}{% endblock %}
        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          {{ widgets.render() }}
        </div>
        {{ partial('_partials/footer.njk', {}, {cache: true}) }}
      </div>
    </footer>
  </div>

{%- set ccIcon = '<i class="ic i-creative-commons"></i>' %}
{%- set ccText = theme.creative_commons.license | upper %}
<script data-config type="text/javascript">
  var LOCAL = {
    path: '{{ _permapath(page.path) }}',
    favicon: {
      show: "{{ __('favicon.show') }}",
      hide: "{{ __('favicon.hide') }}"
    },
    search : {
      placeholder: "{{ __('search.placeholder') }}",
      empty: "{{ __('search.empty') }}",
      stats: "{{ __('search.stats') }}"
    },
    {%- if theme.widgets.recent_comments or page.comment !== false  %}
    valine: {{ page.valine|safedump if page.valine else "true"  }},{%- endif %}
    {%- if page.chart %}chart: true,{%- endif %}
    {%- if page.math %}copy_tex: true,
    katex: true,{%- endif %}
    {%- if page.mermaid %}mermaid: true,{%- endif %}
    {%- if page.audio %}audio: {{ page.audio|safedump }},{%- endif %}
    {%- if page.audio === false %}audio: {},{%- endif %}
    {%- if page.fancybox !== false %}fancybox: true,{%- endif %}
    {%- if page.copyright !== false %}
    {%- if page.copyright === true %}nocopy: true,
    copyright: '{{ __("tips.nocopy")}}',{%- else %}
    copyright: '{{ __("tips.copyright", ccIcon + ccText) }}',
    {%- endif %}{%- endif %}
    {%- if page.quiz %}quiz: {
      choice: "{{ __('quiz.choice') }}",
      multiple: "{{ __('quiz.multiple') }}",
      true_false: "{{ __('quiz.true_false') }}",
      essay: "{{ __('quiz.essay') }}",
      gap_fill: "{{ __('quiz.gap_fill') }}",
      mistake: "{{ __('quiz.mistake') }}"
    },{%- endif %}
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }{%- if theme.quicklink.ignores %},
      {{ theme.quicklink.ignores|safedump }}
      {%- endif %}
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

{# <script async src="/js/sakura-small.js"></script> #}

{# <script src="https://unpkg.com/pace-js@1.0.2/pace.min.js"></script>
<script src="https://unpkg.com/pjax@0.2.8/pjax.min.js"></script>
<script src="https://unpkg.com/whatwg-fetch@3.4.0/dist/fetch.umd.js"></script>
<script src="https://unpkg.com/animejs@3.2.0/lib/anime.min.js"></script>
<script src="https://unpkg.com/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="https://unpkg.com/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="https://unpkg.com/lozad@1/dist/lozad.min.js"></script>
<script src="https://unpkg.com/quicklink@2/dist/quicklink.umd.js"></script> #}


{{ _vendor_js() }}

{{ _js('app.js')}}

{{ partial('_partials/third-party/baidu-analytics.njk', {}, {cache: true}) }}

</body>
</html>
